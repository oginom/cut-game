# 新春カニカニパニック! - ゲーム仕様書

## 概要

スマートフォンのインカメラを使用したハンドジェスチャー操作ゲーム。
プレイヤーは両手の「カニのハサミ」で宝物を吊るすロープを切断し、スコアを競う。

## 技術スタック

- **フレームワーク**: Vite + TypeScript
- **3D描画**: Three.js
- **物理演算**: Rapier
- **ハンドトラッキング**: Google MediaPipe Hands

## ゲームフロー

### 1. タイトル画面

- タイトル: **"新春カニカニパニック!"**
- 注意事項の表示:
  - "このゲームはカメラ入力を利用します。次の画面でカメラを許可してください。"
- 全画面表示

### 2. セットアップ画面

- 表示内容:
  - "適当な場所にスマホを置いて、適度に距離を取ってください。"
  - "このゲームは体で操作します。周囲には十分気をつけてください。"
- カメラ許可の取得
- ハンドトラッキングの初期化
- トラッキング成功後、ゲーム開始

### 3. 設定画面

#### カメラ設定
- **カメラ表示 ON/OFF**
  - ON: カメラ映像を背景に表示
  - OFF: キャラクター画像を背景に表示

#### 顔表示設定（カメラON時のみ有効）
- **顔表示 ON/OFF**
  - ON: プレイヤーの顔をそのまま表示
  - OFF: 顔の位置にキャラクターの顔3Dモデルを表示

### 4. ゲーム画面

#### ゲームルール
- **制限時間**: 30秒
- **目的**: 左右から登場する宝物のロープを切断してスコアを獲得

#### 操作方法
- **ジェスチャー検出**:
  - 両手でピース（Vサイン）を作る
  - Vを閉じる動作で「切断」の当たり判定が発生
  - 当たり判定の範囲内にロープがあれば切断成功

#### ビジュアル
- **プレイヤーの手**: 両手にカニの手の3Dモデルを表示
  - 開いた状態（ピース時）
  - 閉じた状態（切断時）
- **宝物**: ロープに吊られて左右から移動
- **ロープ**: Rapierによる物理演算で揺れる
- **背景**: カメラ映像 or キャラクター画像（設定による）
- **顔**: カメラ映像 or キャラクター顔3Dモデル（設定による）

#### ゲーム処理
- **ロジック**: 2D空間で処理
- **レンダリング**: 3D空間で表示

### 5. リザルト画面

- **表示内容**:
  - 獲得スコア
  - リプレイボタン
  - タイトルに戻るボタン

## スコアシステム

### 基本スコア
- 宝物の種類によって得点が異なる（詳細は今後定義）

### ボーナス要素
- コンボボーナス: 連続で切断成功時に得点アップ（詳細は今後定義）

## ゲームバランス

### 難易度調整要素

#### 宝物の出現パターン
- 出現頻度の調整
- 移動速度の調整
- 時間経過による難易度上昇

#### ロープの切りやすさ
- 当たり判定のサイズ
- ジェスチャー認識の厳密さ

## アセット

### 3Dモデル
- カニの手（開）
- カニの手（閉）
- キャラクターの顔
- 宝物（複数種類）

### 2Dアセット
- キャラクター画像（背景用）
- UIパーツ

## 対応環境

- スマートフォンブラウザ（インカメラ搭載）
- カメラ・ジャイロスコープへのアクセス許可が必要

## 制約事項

- インターネット接続必須（MediaPipeの読み込みに必要な場合）
- プレイには十分な明るさが必要
- プレイスペースの確保が必要（手を動かせる範囲）
