# 実装ガイド

このドキュメントには、実装中に発見した重要な情報や注意事項を記載します。

## 実装の基本原則

### 1. Phaseの開始時には詳細な実装プランを作成する

各Phaseの実装を開始する前に、必ず詳細な実装計画書を作成してください。

- 計画書は`doc/XX_phase_name.md`の形式で作成する（例: `doc/01_camera_and_tracking.md`）
- 各Stepごとに以下を明記する:
  - 目的
  - タスク詳細（実装する機能、メソッド、設定など）
  - 完了条件（チェックリスト形式）
  - 検証方法
- コード例やサンプルを含める
- 型定義やクラス設計も事前に計画する

### 2. Stepごとに実装する

実装は必ずStepごとに段階的に進めてください。

- 1つのStepが完了してから次のStepに進む
- 各Step完了時には、完了条件をすべて満たしていることを確認する
- 計画書のチェックボックスを更新する
- 動作確認を行い、問題がないことを確認する

**一度に複数のStepを実装しない**ことが重要です。段階的な実装により、問題の早期発見と修正が可能になります。

### 3. ユーザー指示を適宜implementation-guideに追加する

実装中にユーザーから指示や指摘があった場合は、このドキュメント（`doc/implementation-guide.md`）に記録してください。

- 実装時の注意事項
- プロジェクト固有の制約や要件
- 使用するツールやライブラリの選定理由
- 発見したバグや回避方法
- パフォーマンス最適化のヒント

このドキュメントは、今後の実装の参考資料として機能します。

## プロジェクト設定

### パッケージマネージャー

**pnpmを使用する**

このプロジェクトでは`pnpm`をパッケージマネージャーとして使用します。`npm`や`yarn`は使用しないでください。

```bash
# 正しい
pnpm install
pnpm run dev
pnpm add <package-name>

# 間違い
npm install
yarn install
```

### プロジェクト構成

このプロジェクトは既存のViteプロジェクトです。新規にViteプロジェクトを初期化する必要はありません。

- Viteは既に設定済み
- TypeScriptは既に設定済み
- 必要なディレクトリ構造は手動で作成

## Step 1.1: プロジェクトセットアップ - 完了事項

### 完了した作業

1. **Viteプロジェクト確認**
   - 既存のViteプロジェクトを確認
   - 新規初期化は不要

2. **パッケージインストール**
   - pnpmを使用して全パッケージをインストール
   - インストールしたパッケージ:
     - `three` @0.182.0
     - `@types/three` @0.182.0
     - `@dimforge/rapier3d-compat` @0.19.3
     - `@mediapipe/hands` @0.4.1675469240
     - `@mediapipe/camera_utils` @0.3.1675466862
     - `@mediapipe/drawing_utils` @0.3.1675466124
     - `@mediapipe/face_detection` @0.4.1646425229

3. **TypeScript設定の調整**
   - [tsconfig.json:16-17](tsconfig.json#L16-L17)に以下を追加:
     - `esModuleInterop: true`
     - `allowSyntheticDefaultImports: true`
   - これらの設定はMediaPipeライブラリとの互換性のために必要

4. **ディレクトリ構造の作成**
   - 以下のディレクトリを作成:
     ```
     src/
     ├── components/
     │   ├── camera/
     │   ├── game/
     │   ├── renderer/
     │   └── ui/
     ├── types/
     └── utils/
     ```

5. **ビルド確認**
   - `pnpm run build`でビルドが成功することを確認
   - TypeScriptコンパイルエラーなし

## 注意事項

### パッケージ管理

- **常にpnpmを使用する**: このプロジェクトではpnpmがパッケージマネージャーとして採用されています
- package.jsonを直接編集せず、`pnpm add`コマンドを使用してパッケージを追加してください

### TypeScript設定

- `tsconfig.json`の既存設定は維持する
- 新しい設定を追加する場合は、既存の設定と競合しないか確認する

### ディレクトリ構造

- 計画書通りのディレクトリ構造を維持する
- 新しいコンポーネントは適切なディレクトリに配置する

## 次のステップ

Step 1.2: カメラ入力の取得と表示
- 型定義ファイルの作成
- CameraViewコンポーネントの実装
- メインファイルでの動作確認
- スタイリング
